{"version":3,"file":"index.min.js","sources":["../utils.js"],"sourcesContent":["export const simpleId = () => Math.random().toString(36).substring(2, 16)\n\nexport const asyncTimeout = ms => new Promise(resolve => {\n  setTimeout(() => resolve(), ms)\n})\n\nexport const minimalFlow = () => ({\n  name: 'foo',\n  steps: {\n    one: {},\n    two: {}\n  }\n})\n\nexport const minimalFlowWithExtension = (bubble) => {\n  const flow = minimalFlow()\n  flow.foo = bubble === null\n    ? { bar: 'baz' }\n    : [{ bar: 'baz' }, bubble || 'all']\n  return flow\n}\n\nexport const asyncEvent = (wf, name, trigger) => new Promise((resolve, reject) => {\n  const handler = () => {\n    wf.off(name, handler)\n    resolve()\n  }\n  try {\n    wf.on(name, handler)\n    trigger()\n  } catch (e) {\n    reject(e)\n  }\n})\n\nexport const start = async (wf, trigger = () => wf.start()) => asyncEvent(wf, 'started', trigger)\n\nexport const next = async (wf, trigger = () => wf.current.complete()) => asyncEvent(wf, 'step', trigger)\n\nexport const end = async (wf, trigger = () => wf.current.complete()) => asyncEvent(wf, 'end', trigger)\n\nexport const error = async (wf, trigger) => asyncEvent(wf, 'error', trigger)\n\nexport const prev = async (wf) => {\n  const last = wf.history[wf.history.length - 1]\n  await next(wf, () => wf.step(last.name))\n}\n\nexport const setId = fn => internal => {\n  const original = internal.id\n  internal.id = fn\n  return () => {\n    internal.id = original\n  }\n}\n\nexport const props = (obj) => {\n  const p = []\n  for (; obj != null; obj = Object.getPrototypeOf(obj)) {\n    const op = Object.getOwnPropertyNames(obj)\n    for (let i = 0; i < op.length; i++) { if (p.indexOf(op[i]) === -1) p.push(op[i]) }\n  }\n  return p\n}\nexport const objectProps = props({})\n"],"names":["simpleId","Math","random","toString","substring","asyncTimeout","ms","Promise","resolve","setTimeout","minimalFlow","name","steps","one","two","minimalFlowWithExtension","bubble","flow","foo","bar","asyncEvent","wf","trigger","reject","handler","off","on","e","start","async","next","current","complete","end","error","prev","last","history","length","step","setId","fn","internal","original","id","props","obj","p","Object","getPrototypeOf","op","getOwnPropertyNames","i","indexOf","push","objectProps"],"mappings":"AAAY,MAACA,EAAW,IAAMC,KAAKC,SAASC,SAAS,IAAIC,UAAU,EAAG,IAEzDC,EAAeC,GAAM,IAAIC,SAAQC,IAC5CC,YAAW,IAAMD,KAAWF,EAAG,IAGpBI,EAAc,KAAO,CAChCC,KAAM,MACNC,MAAO,CACLC,IAAK,CAAE,EACPC,IAAK,CAAE,KAIEC,EAA4BC,IACvC,MAAMC,EAT0B,CAChCN,KAAM,MACNC,MAAO,CACLC,IAAK,CAAE,EACPC,IAAK,CAAE,IAST,OAHAG,EAAKC,IAAiB,OAAXF,EACP,CAAEG,IAAK,OACP,CAAC,CAAEA,IAAK,OAASH,GAAU,OACxBC,GAGIG,EAAa,CAACC,EAAIV,EAAMW,IAAY,IAAIf,SAAQ,CAACC,EAASe,KACrE,MAAMC,EAAU,KACdH,EAAGI,IAAId,EAAMa,GACbhB,GAAS,EAEX,IACEa,EAAGK,GAAGf,EAAMa,GACZF,GACD,CAAC,MAAOK,GACPJ,EAAOI,EACR,KAGUC,EAAQC,MAAOR,EAAIC,EAAU,KAAMD,EAAGO,WAAYR,EAAWC,EAAI,UAAWC,GAE5EQ,EAAOD,MAAOR,EAAIC,EAAU,KAAMD,EAAGU,QAAQC,cAAeZ,EAAWC,EAAI,OAAQC,GAEnFW,EAAMJ,MAAOR,EAAIC,EAAU,KAAMD,EAAGU,QAAQC,cAAeZ,EAAWC,EAAI,MAAOC,GAEjFY,EAAQL,MAAOR,EAAIC,IAAYF,EAAWC,EAAI,QAASC,GAEvDa,EAAON,MAAOR,IACzB,MAAMe,EAAOf,EAAGgB,QAAQhB,EAAGgB,QAAQC,OAAS,SACtCR,EAAKT,GAAI,IAAMA,EAAGkB,KAAKH,EAAKzB,OAAM,EAG7B6B,EAAQC,GAAMC,IACzB,MAAMC,EAAWD,EAASE,GAE1B,OADAF,EAASE,GAAKH,EACP,KACLC,EAASE,GAAKD,CAAQ,CACvB,EAGUE,EAASC,IACpB,MAAMC,EAAI,GACV,KAAc,MAAPD,EAAaA,EAAME,OAAOC,eAAeH,GAAM,CACpD,MAAMI,EAAKF,OAAOG,oBAAoBL,GACtC,IAAK,IAAIM,EAAI,EAAGA,EAAIF,EAAGZ,OAAQc,KAAiC,IAAtBL,EAAEM,QAAQH,EAAGE,KAAYL,EAAEO,KAAKJ,EAAGE,GAC9E,CACD,OAAOL,GAEIQ,EAAcV,EAAM,CAAE,UAAAzB,gBAAAf,kBAAA4B,SAAAC,WAAAxB,iBAAAK,8BAAAe,UAAAyB,iBAAApB,UAAAU,WAAAL,WAAAxC,cAAA4B"}