{"version":3,"file":"index.iife.js","sources":["../utils.js"],"sourcesContent":["export const simpleId = () => Math.random().toString(36).substring(2, 16)\n\nexport const asyncTimeout = ms => new Promise(resolve => {\n  setTimeout(() => resolve(), ms)\n})\n\nexport const minimalFlow = () => ({\n  name: 'foo',\n  steps: {\n    one: {},\n    two: {}\n  }\n})\n\nexport const minimalFlowWithExtension = (bubble) => {\n  const flow = minimalFlow()\n  flow.foo = bubble === null\n    ? { bar: 'baz' }\n    : [{ bar: 'baz' }, bubble || 'all']\n  return flow\n}\n\nexport const asyncEvent = (wf, name, trigger) => new Promise((resolve, reject) => {\n  const handler = () => {\n    wf.off(name, handler)\n    resolve()\n  }\n  try {\n    wf.on(name, handler)\n    trigger()\n  } catch (e) {\n    reject(e)\n  }\n})\n\nexport const start = async (wf, trigger = () => wf.start()) => asyncEvent(wf, 'started', trigger)\n\nexport const next = async (wf, trigger = () => wf.current.complete()) => asyncEvent(wf, 'step', trigger)\n\nexport const end = async (wf, trigger = () => wf.current.complete()) => asyncEvent(wf, 'end', trigger)\n\nexport const error = async (wf, trigger) => asyncEvent(wf, 'error', trigger)\n\nexport const prev = async (wf) => {\n  const last = wf.history[wf.history.length - 1]\n  await next(wf, () => wf.step(last.name))\n}\n\nexport const setId = fn => internal => {\n  const original = internal.id\n  internal.id = fn\n  return () => {\n    internal.id = original\n  }\n}\n\nexport const props = (obj) => {\n  const p = []\n  for (; obj != null; obj = Object.getPrototypeOf(obj)) {\n    const op = Object.getOwnPropertyNames(obj)\n    for (let i = 0; i < op.length; i++) { if (p.indexOf(op[i]) === -1) p.push(op[i]) }\n  }\n  return p\n}\nexport const objectProps = props({})\n"],"names":["simpleId","Math","random","toString","substring","asyncTimeout","ms","Promise","resolve","setTimeout","minimalFlow","name","steps","one","two","minimalFlowWithExtension","bubble","flow","foo","bar","asyncEvent","wf","trigger","reject","handler","off","on","e","start","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_args","arguments","wrap","_callee$","_context","prev","next","length","undefined","abrupt","stop","_x","apply","_ref2","_callee2","_args2","_callee2$","_context2","current","complete","_x2","end","_ref3","_callee3","_args3","_callee3$","_context3","_x3","error","_ref4","_callee4","_callee4$","_context4","_x4","_x5","_ref5","_callee5","last","_callee5$","_context5","history","step","_x6","setId","fn","internal","original","id","props","obj","p","Object","getPrototypeOf","op","getOwnPropertyNames","i","indexOf","push","objectProps"],"mappings":"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"}