{"version":3,"file":"index.iife.min.js","sources":["../utils.js"],"sourcesContent":["export const simpleId = () => Math.random().toString(36).substring(2, 16)\n\nexport const asyncTimeout = ms => new Promise(resolve => {\n  setTimeout(() => resolve(), ms)\n})\n\nexport const minimalFlow = () => ({\n  name: 'foo',\n  steps: {\n    one: {},\n    two: {}\n  }\n})\n\nexport const minimalFlowWithExtension = (bubble) => {\n  const flow = minimalFlow()\n  flow.foo = bubble === null\n    ? { bar: 'baz' }\n    : [{ bar: 'baz' }, bubble || 'all']\n  return flow\n}\n\nexport const asyncEvent = (wf, name, trigger) => new Promise((resolve, reject) => {\n  const handler = () => {\n    wf.off(name, handler)\n    resolve()\n  }\n  try {\n    wf.on(name, handler)\n    trigger()\n  } catch (e) {\n    reject(e)\n  }\n})\n\nexport const start = async (wf, trigger = () => wf.start()) => asyncEvent(wf, 'started', trigger)\n\nexport const next = async (wf, trigger = () => wf.current.complete()) => asyncEvent(wf, 'step', trigger)\n\nexport const end = async (wf, trigger = () => wf.current.complete()) => asyncEvent(wf, 'end', trigger)\n\nexport const error = async (wf, trigger) => asyncEvent(wf, 'error', trigger)\n\nexport const prev = async (wf) => {\n  const last = wf.history[wf.history.length - 1]\n  await next(wf, () => wf.step(last.name))\n}\n\nexport const setId = fn => internal => {\n  const original = internal.id\n  internal.id = fn\n  return () => {\n    internal.id = original\n  }\n}\n\nexport const props = (obj) => {\n  const p = []\n  for (; obj != null; obj = Object.getPrototypeOf(obj)) {\n    const op = Object.getOwnPropertyNames(obj)\n    for (let i = 0; i < op.length; i++) { if (p.indexOf(op[i]) === -1) p.push(op[i]) }\n  }\n  return p\n}\nexport const objectProps = props({})\n"],"names":["simpleId","minimalFlow","name","steps","one","two","asyncEvent","wf","trigger","Promise","resolve","reject","on","handler","off","e","start","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_args","arguments","wrap","_context","prev","next","length","undefined","abrupt","stop","_x","apply","this","_ref2","_callee2","_args2","_context2","current","complete","_x2","end","_ref3","_callee3","_args3","_context3","_x3","error","_ref4","_callee4","_context4","_x4","_x5","_ref5","_callee5","last","_context5","history","step","_x6","props","obj","p","Object","getPrototypeOf","op","getOwnPropertyNames","i","indexOf","push","objectProps","exports","asyncTimeout","ms","setTimeout","minimalFlowWithExtension","bubble","flow","foo","bar","setId","fn","internal","original","id","Math","random","toString","substring"],"mappings":"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"}