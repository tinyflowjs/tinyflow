"use strict";module.exports.withInstances=()=>(e,{Workflow:t,Tinyflow:n,TinyflowError:s})=>{e.instances=new Map;const{instances:o,listeners:r}=e;return n.get=e=>o.get(e),n.all=()=>[...o.values()],n.clear=()=>{const e=[...o.keys()];for(const t of e){n.get(t).cancel(),n.dispose(t)}},n.create=e=>{const n=new t(e);return o.set(n.id,n),n},n.dispose=(e,{force:t=!1}={})=>{const n=o.get(e);if(!n)throw new s(`Workflow does not exist by id ${e}`);if(!t&&"active"===n.state)throw new s(`Cannot dispose active workflow "${n.name}"`,{instanceId:e});n.current&&(n.current.off(),n.current=null),n.off(),r.delete(n),o.delete(e)},()=>{delete e.instances,delete n.get,delete n.all,delete n.clear,delete n.create,delete n.dispose}};//# sourceMappingURL=withInstances.min.cjs.map
